var ObservableItem=function(){function a(a,b,c){this.name=a,this.item=b,this.index=c}return a}(),__extends=this&&this.__extends||function(a,b){function c(){this.constructor=a}for(var d in b)b.hasOwnProperty(d)&&(a[d]=b[d]);a.prototype=null===b?Object.create(b):(c.prototype=b.prototype,new c)},ObservableArray=function(a){function b(b,c){a.call(this),this._name=b,c?this._binding=c:this._binding=null}return __extends(b,a),Object.defineProperty(b.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Object.defineProperty(b.prototype,"propertyChangeEvent",{get:function(){return"propertyChange"+this.name},enumerable:!0,configurable:!0}),b.prototype.initialize=function(b){var c=this;b.forEach(function(b){return a.prototype.push.call(c,b)})},b.prototype.push=function(){for(var b=this,c=[],d=0;d<arguments.length;d++)c[d-0]=arguments[d];var e=0;return c.forEach(function(c){c._parentReference=b,e=a.prototype.push.call(b,c),null===b._binding?(b.elementAdded=new CustomEvent(b.name+"elementAdded",{detail:new ObservableItem(b.name,c,e)}),document.dispatchEvent(b.elementAdded)):b._binding.dispatchChangeEvent(null)}),e},b.prototype.pop=function(){var b=this.length-1,c=a.prototype.pop.call(this);return null===this._binding?(this.elementRemoved=new CustomEvent(this.name+"elementRemoved",{detail:new ObservableItem(this.name,c,b)}),document.dispatchEvent(this.elementRemoved)):this._binding.dispatchChangeEvent(null),c},b.prototype.unshift=function(){for(var b=this,c=[],d=0;d<arguments.length;d++)c[d-0]=arguments[d];var e=0;return c.forEach(function(c){c._parentReference=b,e=a.prototype.unshift.call(b,c),null===b._binding?(b.elementAdded=new CustomEvent(b.name+"elementAdded",{detail:new ObservableItem(b.name,c,e)}),document.dispatchEvent(b.elementAdded)):b._binding.dispatchChangeEvent(null)}),e},b.prototype.shift=function(){var b=a.prototype.shift.call(this);return null===this._binding?(this.elementRemoved=new CustomEvent(this.name+"elementRemoved",{detail:new ObservableItem(this.name,b,0)}),document.dispatchEvent(this.elementRemoved)):this._binding.dispatchChangeEvent(null),b},b.prototype.splice=function(a,b){for(var c=this,d=[],e=2;e<arguments.length;e++)d[e-2]=arguments[e];var f=null;return f=d&&d.length>0?Array.prototype.splice.call(this,a,b,d):Array.prototype.splice.call(this,a,b),f.forEach(function(a){null===c._binding?(c.elementRemoved=new CustomEvent(c.name+"elementRemoved",{detail:new ObservableItem(c.name,a,0)}),document.dispatchEvent(c.elementRemoved)):c._binding.dispatchChangeEvent(null)}),f},b.prototype.change=function(a,b){if("object"==typeof b){var c=this[a];for(var d in c)b[d]&&(c[d]=b[d])}else this[a]=b,this._binding.dispatchChangeEvent(null)},b}(Array);!function(){function a(a,b){b=b||{bubbles:!1,cancelable:!1,detail:void 0};var c=document.createEvent("CustomEvent");return c.initCustomEvent(a,b.bubbles,b.cancelable,b.detail),c}a.prototype=Event.prototype,window.CustomEvent=a}();var ModelView=function(){function a(a,b,c,d,e){var f=this;if(this.modelName=a,this.properties=new Array,this.bindings||(this.bindings={}),this.subModels=new Array,this.isInitialization=!0,e?this.originalModel=e:this.originalModel=this,b)if(this.model=b,b["mutated-observation"]){var g=b["mutated-accesors"];for(var h in g){var i=this.modelName+"|"+g[h],j=b["_"+g[h]];j.name=this.modelName+"|"+g[h],this.bindings[i]=j}}else this.createObservableObject(this.model,this.modelName);if(a){var k=[];if(c){k=this.getAllDuetNodes(c);var l=new ModelProperty(this,c);this.properties.push(l)}else k=this.getAllDuetNodes();k.length>0&&k.forEach(function(a,b){var c=new ModelProperty(f,a);f.properties.push(c)}),this.properties.forEach(function(a){for(var b in a.internalBindings)a.setComponentBinding(a.bindings[b])})}this.isInitialization=!1}return Object.defineProperty(a.prototype,"bindings",{get:function(){return window[this.modelName+"_dt-bindings"]},set:function(a){window[this.modelName+"_dt-bindings"]=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"modelName",{get:function(){return this._modelName},set:function(a){this._modelName=a},enumerable:!0,configurable:!0}),a.prototype.unbind=function(){this.bindings={},this.properties.forEach(function(a){return a.isUnbind=!0}),this._isUnbind=!0,this.subModels.forEach(function(a){return a.unbind()})},a.prototype.getAllDuetNodes=function(a){a||(a=document);for(var b=a.getElementsByTagName("*"),c=[],d=[],e=0;e<b.length;e++){var f=b[e],g=!1;if(f.attributes.hasOwnProperty("dt")||f.attributes.hasOwnProperty("data-dt")?f.attributes.hasOwnProperty("dt")?k=f.attributes.dt.value==this.modelName:f.attributes.hasOwnProperty("data-dt")&&(k=f.attributes["data-dt"].value==this.modelName):k="duet.model"==this.modelName,k)for(var h=0;h<f.attributes.length&&!g;h++){var i=f.attributes[h],j=i.name,k=!0;if(0==i.name.indexOf("data-")&&(j=i.name.slice(5)),0==j.indexOf("dt")||0==j.indexOf("dt")&&"dt-binding-generation"!=j){for(var l=!1,m=0;m<d.length&&!l;m++)l=d[m].contains(f);l||(c.push(f),(f.hasAttribute("dt-children")||f.hasAttribute("data-dt-children"))&&d.push(f)),g=!0}}}return c},a.prototype.createObservableObject=function(a,b){if(!("object"!=typeof a||a&&a["mutated-observation"])){var c=this,d="";b&&(d=b);var e=[];for(var f in a)e.push(f);for(var f in e){var g=e[f];if(0!=g.indexOf("_")&&"function"!=typeof a[g]&&"mutated-accesors"!==g&&0!=g.indexOf("$")){var h=d+"|"+g,i=this.bindings[h];"undefined"==typeof i&&(i=new BindableProperty(h,g,a[g],a,this.originalModel.model,null,!0)),ModelProperty.createAccesorProperty(g,a,i),this.createObservableObject(a[g],h),this.bindings[h]=i,document.addEventListener(i.propertyChangeEvent,function(b){return c._isUnbind?void document.removeEventListener(i.propertyChangeEvent,arguments.callee,!1):void(c.isInitialization||(c.checkBindDependencies(b),a._parentReference&&a._parentReference._binding&&a._parentReference._binding.dispatchChangeEvent(b.detail.internalExpression)))},!1)}}null!=a&&(a["mutated-observation"]=!0)}},a.prototype.checkBindDependencies=function(a){var b=a.detail.internalExpression;a.detail._externalReference&&null!=a.detail._externalReference&&(b=a.detail._externalReference);for(var c in this.bindings){var d=this.bindings[c];if((0==d.internalExpression.indexOf("#")||d.isFunction)&&d.internalExpression!==b){var e=d.internalExpression;d.isFunction&&(e=d.funcDefinition),-1!==d.references.indexOf(b)?d.dispatchChangeEvent():this.containsBindReference(e,b)?(d.dispatchChangeEvent(),d.references.push(b)):this.containsBindReference(e,"$"+b)?(d.dispatchChangeEvent(),d.references.push(b)):this.containsBindReference(e,b+"_stringify")&&(d.dispatchChangeEvent(),d.references.push(b))}}},a.isAlphanumeric=function(a,b){var c=a.charCodeAt(b);return c>47&&58>c||c>64&&91>c||c>96&&123>c?!0:!1},a.prototype.containsBindReference=function(b,c){for(var d=!1,e=b.indexOf(c);-1!=e;)"."===b[e-1]&&b.length>=e+c.length&&!a.isAlphanumeric(b,e+c.length)?(d=!0,e=-1):e=b.indexOf(c,e+1);return d},a}(),ModelProperty=function(){function a(b,c){this.modelView=b,this.component=c,this.componentBindings={},this.pendingSync={},this.internalBindings={};var d=!1;this.createDatasetAttributes(this.component);for(var e in this.component.dataset){if(this.component.dataset.hasOwnProperty(e)&&0==e.indexOf("dt")&&e.length>2){var f=e[2].toLowerCase()+e.slice(3),g=this.component.dataset[e].trim();f=f.replace("html","HTML"),"bindingGeneration"!==f&&(-1===g.indexOf("#")&&(g=g.replace(".","|")),this.componentBindings[f]=this.modelView.modelName+"|"+g,d=!0)}if("undefined"!=typeof this.component[f]&&null!=this.component[f]&&this.component[f].length>0&&this.component[f][0]instanceof HTMLElement){var h=this.component[f][0];"function"==typeof h?this._template=h.contentDocument.body.children[0]:this._template=h,h.dataset.dtBindingGeneration=void 0,this.createDatasetAttributes(h),this.component.removeChild(h)}}if(d){this.createPropertyBinding();for(var i in this.componentBindings){var j=this.componentBindings[i],k=this.bindings[j];this.listenChangeEvents(j,k)}var l=this;this.component.addEventListener("componentSync",function(b){if(b instanceof CustomEvent&&b.detail instanceof a){var c=b.detail;c.component;if(c.isUnbind)return void c.component.removeEventListener("componentSync",arguments.callee,!1);var d=l.component;for(var e in c.pendingSync){var f=l.bindings[l.componentBindings[e]],g=e;if(-1!=g.indexOf(".")){var h=g.split(".");g=h[h.length-1],h=h.slice(0,h.length-1),h.forEach(function(a){d[a]||(d[a]={}),d=d[a]})}f.htmlComponent=d,void 0==f||f.ignore||void 0==c.pendingSync[e]||f.value==c.pendingSync[e]||(f.value=c.pendingSync[e])}}},!1)}this.componentSync=new CustomEvent("componentSync",{detail:this})}return Object.defineProperty(a.prototype,"bindings",{get:function(){return this._modelView.bindings},set:function(a){this._modelView.bindings=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"modelView",{get:function(){return this._modelView},set:function(a){this._modelView=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"template",{get:function(){return this._template},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"isUnbind",{get:function(){return this._isUnbind},set:function(a){this._observer&&a&&this._observer.disconnect(),this._isUnbind=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"component",{get:function(){return this._component},set:function(b){var c=this,d=this;this._component=b,this._observer=new MutationObserver(function(a){a.forEach(function(a){if("childList"===a.type){var b=c._component.dataset.childrenmap;if(c.modelView.isInitialization)return;if(b&&c._template){var d=c.modelView.model[b],e=new Array;d||(d=[]);for(var f=0;f<a.addedNodes.length;f++)if(a.addedNodes[f]instanceof HTMLElement){var g=a.addedNodes[f];g.dataset.dtBindingGeneration||(c.addChildrenListNode(d,g,c._template),e.push(a.addedNodes[f]))}for(var f=0;f<e.length;f++)null!=e[f].parentNode&&e[f].parentNode.removeChild(e[f]);for(var f=0;f<a.removedNodes.length;f++)if(a.removedNodes[f]instanceof HTMLElement){var g=a.removedNodes[f];g.dataset.dtBindingGeneration&&"undefined"!=g.dataset.dtBindingGeneration&&d.splice(parseInt(g.dataset.dtBindingGeneration),1)}}}else c.syncComponentChange(a.target,a.attributeName)}),c.syncDependencies(d)});var e={attributes:!0,childList:!0,characterData:!0};this._observer.observe(this._component,e),this._component.addEventListener("change",function(){d.isUnbind?d._component.removeEventListener("change",arguments.callee,!1):a.syncComponentEvent(d)},!1),this._component.addEventListener("keydown",function(){d.isUnbind?d._component.removeEventListener("keydown",arguments.callee,!1):a.syncComponentEvent(d)},!1),this._component.addEventListener("keyup",function(){d.isUnbind?d._component.removeEventListener("keyup",arguments.callee,!1):a.syncComponentEvent(d)},!1)},enumerable:!0,configurable:!0}),a.prototype.createDatasetAttributes=function(a){for(var b in a.attributes){var c=a.attributes[b];if(c.name&&0==c.name.indexOf("dt")){for(var d=c.name,e=d.indexOf("-");-1!=e;)d=d.replace(/-/,d[e+1].toUpperCase()),d=d.slice(0,e+1)+d.slice(e+2),e=d.indexOf("-");a.dataset[d]=c.value}}},a.prototype.listenChangeEvents=function(a,b){var c=this;document.addEventListener(b.propertyChangeEvent,function(a){return c.isUnbind?void document.removeEventListener(b.propertyChangeEvent,arguments.callee,!1):void c.onBindingChange(a)},!1);var d=this.component,e=a;if(-1!=e.indexOf(".")){var f=e.split(".");e=f[f.length-1],f=f.slice(0,f.length-1),f.forEach(function(a){d[a]||(d[a]={}),d=d[a]})}this.bindings[a].htmlComponent=d,this.bindings[a].value instanceof ObservableArray&&(document.addEventListener(a+"elementAdded",function(b){if(c.isUnbind)return void document.removeEventListener(a+"elementAdded",arguments.callee,!1);if(b.detail instanceof ObservableItem){var d=c.getComponentBinding(b.detail.name);c.bindingObservableItem(b.detail.name,b.detail.index,b.detail.item,d)}}),document.addEventListener(a+"elementRemoved",function(b){if(c.isUnbind)return void document.removeEventListener(a+"elementRemoved",arguments.callee,!1);if(b.detail instanceof ObservableItem){var d=c.getComponentBinding(b.detail.name);null!=d&&(c.component[d][b.detail.index].dataset.dtBindingGeneration=void 0,c.component[d][b.detail.index].remove?c.component[d][b.detail.index].remove():c.component.removeChild(c.component.children[b.detail.index]))}}))},a.prototype.syncDependencies=function(a){this.modelView.isInitialization||a.component.dispatchEvent(a.componentSync),a.pendingSync={}},a.prototype.onBindingChange=function(a){a.preventDefault(),this.setComponentBinding(a.detail),this.modelView.isInitialization||this.modelView.checkBindDependencies(a)},a.prototype.bindingObservableItem=function(a,b,c,d){if(this.bindings[a]&&void 0!=this._template){var e=this.modelView.modelName+"|"+a+"|"+b;if(this.modelView.subModels.some(function(a){return a.modelName===e})){var f=null,g=-1;this.modelView.subModels.forEach(function(a){g++,a.modelName==e&&(f=g)}),f>-1&&(this.modelView.subModels[f].bindings={},this.modelView.subModels.splice(f,1))}this._component instanceof HTMLSelectElement&&this._template.dataset&&(this._template.dataset.dtValue||this._template.dataset.dtText)&&(this._template.dataset.dtValue?this.bindings[a].selectValueProp=this._template.dataset.dtValue:this.bindings[a].selectValueProp=this._template.dataset.dtText);var h=this._template.cloneNode(!0);h instanceof HTMLElement&&(h.dataset.dtBindingGeneration=b.toString()),this.component.appendChild(h);var i=new ModelView(e,c,h,d,this.modelView.originalModel);this.modelView.subModels.push(i)}},a.prototype.getComponentBinding=function(a){var b="";for(var c in this.componentBindings)if(a==this.componentBindings[c]){b=c;break}return b},a.prototype.syncComponentChange=function(a,b){if(a instanceof HTMLElement)for(var c in this.componentBindings){var d=c;if(-1!=c.indexOf(".")&&(d=d.split(".")[0]),d===b){var e=a;if(-1!=c.indexOf(".")){var f=c.split(".");d=f[f.length-1],f=f.slice(0,f.length-1),f.forEach(function(a){e[a]||(e[a]={}),e=e[a]})}this.pendingSync[c]=e[d];break}}},a.prototype.createPropertyBinding=function(){for(var b in this.componentBindings){var c=this.componentBindings[b],d=null;if(this.bindings&&this.bindings[c])d=this.bindings[c],this.internalBindings[c]=d;else{var e=this.modelView.model,f="",g=c;if(-1!==g.indexOf("|")&&(g=g.replace(this.modelView.modelName+"|",""),-1===g.indexOf("#")&&(g=g.replace("|","."))),0!=g.indexOf("#")&&0!=g.indexOf("@")&&-1!=g.indexOf(".")){var h=g.split(".");f=h[h.length-2],g=h[h.length-1],h=h.slice(0,h.length-1),h.forEach(function(a){e[a]||(e[a]={}),e=e[a]})}d=new BindableProperty(c,g,e[g],e,this.modelView.originalModel.model,this.component),a.createAccesorProperty(g,e,d),this.bindings||(this.bindings={}),this.internalBindings[c]=d,this.bindings[c]=d}}},a.prototype.setComponentBinding=function(a){a.dirty=!0;var b=this.component,c=this.getComponentBinding(a.name);if(null!=c&&-1!=c.indexOf(".")){var d=c.split(".");c=d[d.length-1],d=d.slice(0,d.length-1),d.forEach(function(a){b[a]||(b[a]={}),b=b[a]})}if(a.htmlComponent=b,"undefined"!=typeof b[c])if(null!=b[c]&&b[c].__proto__==HTMLCollection.prototype){if(a.dirty){for(var e=b[c].length-1;e>-1;e--)b[c][e].dataset.dtBindingGeneration=void 0,b[c][e].remove?b[c][e].remove():this.component.removeChild(this.component.children[e]);if(Array.isArray(a.value)||a.value instanceof ObservableArray)for(var f=0;f<a.value.length;f++)this.bindingObservableItem(a.name,f,a.value[f],c);else this.bindingObservableItem(a.name,0,a.value,c)}}else if("undefined"!=typeof a.value)if(b.multiple&&"value"===c)for(var g=b.children.length,f=0;g>f;f++)null!=a.value&&-1!==a.value.indexOf(b.children[f].value)?b.children[f].selected=!0:b.children[f].selected=!1;else b[c]=a.value},a.prototype.addChildrenListNode=function(a,b,c){var d=this._modelView.getAllDuetNodes(c),e=b.querySelectorAll("*"),f=c.querySelectorAll("*"),g={};this.mapTemplateNode(g,c,b);for(var h=0;h<f.length&&!(e.length<h);h++){var i=f[h];if(-1!==d.indexOf(i)){var j=e[h];if(i instanceof HTMLElement&&j instanceof HTMLElement){var k=i,l=j;this.mapTemplateNode(g,k,l)}}}a.push(g)},a.prototype.mapTemplateNode=function(a,b,c){for(var d in b.dataset)if(b.dataset.hasOwnProperty(d)&&0==d.indexOf("dt")&&d.length>2){var e=d[2].toLowerCase()+d.slice(3),f=b.dataset[d].trim();if(e=e.replace("html","HTML"),"children"===e&&c[e]){var g=b.dataset.childrenmap;if(!a[g]){a[g]=[];for(var h=0;h<c[e].length;h++){var i=0;b[e].length===c[e].length&&(i=h),this.addChildrenListNode(a[g],c[e][h],b[e][i])}}}else-1===f.indexOf("#")&&-1===f.indexOf("@")&&c[e]&&(a[f]=c[e])}},a.createAccesorProperty=function(a,b,c){if(!(Array.isArray(b)||b instanceof ObservableArray||"object"!=typeof b||b["mutated-accesors"]&&-1!=b["mutated-accesors"].indexOf(a))){var d="_"+a;b[d]=c,Object.defineProperty(b,a,{get:function(){return this[d].value},set:function(a){this[d].value=a},enumerable:!0,configurable:!0}),Object.defineProperty(b,"$"+a,{get:function(){return this[d].objectValue},enumerable:!0,configurable:!0}),Object.defineProperty(b,a+"_stringify",{get:function(){return this[d].stringValue},enumerable:!0,configurable:!0}),b["mutated-accesors"]||(b["mutated-accesors"]=[]),b["mutated-accesors"].push(a)}},a.syncComponentEvent=function(a){for(var b in a.componentBindings)if("undefined"!=typeof a.component[b]&&a.component[b].__proto__!==HTMLCollection.prototype)if(a.component.multiple){for(var c=a.component.children.length,d=[],e=0;c>e;e++)a.component.children[e].selected&&d.push(a.component.children[e].value);a.pendingSync[b]=d}else a.pendingSync[b]=a.component[b];a.syncDependencies(a)},a}(),DynamicCode=function(){function DynamicCode(){}return DynamicCode.evalInContext=function(js,context){return function(){return eval(js)}.call(context)},DynamicCode.parseLambdaExpression=function(a){for(var b=a,c=a.indexOf("=>",c);-1!=c;){for(var d=DynamicCode.getLamdbaStart(a,c),e=a.length-1,f=0,g="",h=c;h<a.length-1;h++){if(")"===a[h]){if(0==f){e=h;break}f--}"("===a[h]&&f++}g=DynamicCode.createLambdaFunction(a.slice(d,e+1)),b=b.slice(0,d+1)+g+b.slice(e),c=b.indexOf("=>")}return b},DynamicCode.createLambdaFunction=function(a){var b="",c=a.indexOf("=>"),d=DynamicCode.getLamdbaStart(a,c),e=a.length-1,f=a.slice(d+1,c),g=a.slice(c+2,e);return-1!=g.indexOf("=>")&&(g=DynamicCode.parseLambdaExpression(g)),b="(function("+f+") { return (",b+=g+");})"},DynamicCode.getLamdbaStart=function(a,b){for(var c=b,d=b;d>-1;d--)if("("===a[d]){c=d;break}return c},DynamicCode}(),BindableProperty=function(){function a(a,b,c,d,e,f,g){if(this.dirty=!1,this._funcExpresion=null,this._funcIsChecked=!1,this.name=a,this._internalExpression=b,this._tempValue=null,this._parentValue=d,this._externalReference=null,this.propertyChange=new CustomEvent(this.propertyChangeEvent,{detail:this}),this.model=e,this.htmlComponent=f,this.references=new Array,this.ignore=!1,this._funcDefinitionString=null,this._lastDispatchTime=null,Array.isArray(c)||c instanceof ObservableArray){if(Array.isArray(c)){var h=null;h=g?new ObservableArray(a,this):new ObservableArray(a),h.initialize(c),this.value=h}else this.value=c;this.dirty=!0}else"this"===b?this.value=d:this.value=c}return Object.defineProperty(a.prototype,"funcDefinition",{get:function(){return null==this._funcDefinitionString&&(this._funcDefinitionString=this._funcDefinition.toString().replace(" ","")),this._funcDefinitionString},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"internalExpression",{get:function(){return this._internalExpression},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"value",{get:function(){var a=this;this.name;if(0!=this._internalExpression.indexOf("#")&&0!=this._internalExpression.indexOf("@")||"undefined"!=typeof this.dirty&&1!=this.dirty){if("function"==typeof this._value&&null===this._funcExpresion){var b=this._parentValue,c=this.model;this.htmlComponent;this._funcExpresion=this._value.toString(),b["_bind_"+this._internalExpression]=this._value;var d="_bind_"+this._internalExpression;this._value=function(){b.model=c,b.view=this,b[d](),b.model=void 0,b.view=void 0}}else if(this.htmlComponent instanceof HTMLSelectElement&&this.htmlComponent.dataset&&this.htmlComponent.dataset.dtValue&&this.htmlComponent.dataset.dtValue===this.internalExpression&&this.htmlComponent.dataset.dtChildren&&this.dirty){var e=this.htmlComponent.dataset.dtChildren,f=this._parentValue["_"+e].selectValueProp;if("undefined"!=typeof f){var g=this.htmlComponent;if(g.multiple){var h=[];if(null!=this._value){this._value instanceof Array||(this._value=[this._value]);for(var i=this._value.length,j=0;i>j;j++)h.push(this._parentValue[e].find(function(b){return b[f]===a._value[j]}))}this._objectValue=h}else this._objectValue=this._parentValue[e].find(function(b){return b[f]===a._value})}this.dirty=!1}}else{var k=null,l=this._funcExpresion;if(null==l&&(l=this._internalExpression.slice(1),-1!=l.indexOf("=>")&&(l=DynamicCode.parseLambdaExpression(l))),0==this._internalExpression.indexOf("@")){null==this._eventExpresion&&(this._eventExpresion=l);var m=this;k=function(){var a=m._parentValue;a.model=m.model,a.view=m.htmlComponent;var b=DynamicCode.evalInContext(m._eventExpresion,a);return a.model=void 0,a.view=void 0,b}}else{if(this._funcExpresion=l,!this._funcIsChecked&&0==l.indexOf("this.")&&-1!=l.indexOf("(")){var n=l.replace("this.","");n=n.slice(0,n.indexOf("(")),this.isFunction=this._parentValue[n]?"function"==typeof this._parentValue[n]:!1,this.isFunction&&(this._funcDefinition=this._parentValue[n]),this._funcIsChecked=!0}var b=this._parentValue;b.model=this.model,b.view=this.htmlComponent,k=DynamicCode.evalInContext(l,b),b.model=void 0,b.view=void 0}this._value=k,this.dirty=!1}return this._value},set:function(a){this._value=a,this.ignore||this.dispatchChangeEvent()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"objectValue",{get:function(){if(this.dirty){this.value}return this._objectValue},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"stringValue",{get:function(){var a="";return a=null!=this.objectValue||"object"==typeof this.objectValue?JSON.stringify(this.originalObject(this.objectValue)):this.value.toString()},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"internalValue",{set:function(a){this._value=a},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"propertyChangeEvent",{get:function(){return"propertyChange"+this.name},enumerable:!0,configurable:!0}),Object.defineProperty(a.prototype,"ignore",{get:function(){return this._ignore},set:function(a){this._ignore&&!a?(this._ignore=a,this.dispatchChangeEvent()):this._ignore=a},enumerable:!0,configurable:!0}),a.prototype.dispatchChangeEvent=function(a){var b=this;return null!==this._lastDispatchTime&&Date.now()-this._lastDispatchTime<50?void(this._pendingEvent||(this._pendingEvent=setTimeout(function(){return b.dispatchChangeEvent(a)},50))):(clearTimeout(this._pendingEvent),this._pendingEvent=void 0,this._lastDispatchTime=Date.now(),void(this.ignore||(a?this._externalReference=a:this._externalReference=null,this.dirty=!0,this.propertyChange=new CustomEvent(this.propertyChangeEvent,{detail:this}),document.dispatchEvent(this.propertyChange))))},a.prototype.originalObject=function(b){var c=null;if(c=Array.isArray(b)||b instanceof ObservableArray?[]:{},b.hasOwnProperty("mutated-accesors")){var d=b["mutated-accesors"];for(var e in d){var f=d[e];if(-1===f.indexOf("#")&&-1===f.indexOf("@")){var g=null;g=b[f]instanceof a?b[f].stringValue:"object"==typeof b[f]?this.originalObject(b[f]):b[f],Array.isArray(c)?c.push(g):c[f]=g}}}else if(Array.isArray(b)||b instanceof ObservableArray)for(var h=0;h<b.length;h++)c.push(this.originalObject(b[h]));else c=b;return c},a}(),duet=function(){function a(){}return a.bind=function(b,c){a.subModels||(a.subModels={}),a.subModelViews||(a.subModelViews={}),c?a.subModels[c]=b:a.model=b,a.readyComplete&&(c?(a.subModelViews[c]&&(a.subModelViews[c].unbind(),a.subModelViews[c]=void 0),a.subModelViews[c]=new ModelView(c,a.subModels[c])):(a.modelView&&a.modelView.unbind(),a.modelView=new ModelView("duet.model",a.model)))},a.init=function(){a.readyBound||(a.readyBound=!0,window.document.addEventListener?window.document.addEventListener("DOMContentLoaded",function(){window.document.removeEventListener("DOMContentLoaded",arguments.callee,!1),a.ready()},!1):window.document.attachEvent&&(window.document.attachEvent("onreadystatechange",function(){"complete"===window.document.readyState&&(window.document.detachEvent("onreadystatechange",arguments.callee),a.ready())}),window.document.documentElement.doScroll&&window==window.top&&function(){if(!a.isReady){try{window.document.documentElement.doScroll("left")}catch(b){return void setTimeout(arguments.callee,0)}a.ready()}}()),window.onload=a.ready)},a.ready=function(){if(!a.isReady){a.isReady=!0,a.model&&(a.modelView=new ModelView("duet.model",a.model));for(var b in a.subModels)a.subModelViews[b]=new ModelView(b,a.subModels[b]);a.readyComplete=!0}},a}();
//# sourceMappingURL=../sourceMap.map